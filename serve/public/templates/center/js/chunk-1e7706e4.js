(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-1e7706e4"],{"1f1e":function(t,e,i){"use strict";i.r(e);var s=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("div",{staticClass:"sale-header"},[i("el-button",{attrs:{size:"mini"}},[t._v("返回")])],1),i("div",{staticClass:"sale-content"},[i("div",{staticClass:"sale-content-item"},[i("div",[t._v("活动名称")]),i("div",[i("el-input",{model:{value:t.discount.discount_name,callback:function(e){t.$set(t.discount,"discount_name",e)},expression:"discount.discount_name"}})],1)]),i("div",{staticClass:"sale-content-item"},[i("div",[t._v("活动备注")]),i("div",[i("el-input",{model:{value:t.discount.discount_desc,callback:function(e){t.$set(t.discount,"discount_desc",e)},expression:"discount.discount_desc"}}),i("div",{staticClass:"discount-tip"},[t._v("此项仅展示在后台页面")])],1)]),i("div",{staticClass:"sale-content-item"},[i("div",[t._v("活动时间")]),i("div",[i("el-date-picker",{attrs:{type:"datetimerange","start-placeholder":"开始日期","end-placeholder":"结束日期","default-time":["00:00:00","23:59:59"]},model:{value:t.datepicker,callback:function(e){t.datepicker=e},expression:"datepicker"}})],1)]),i("div",{staticClass:"sale-content-item"},[i("div",[t._v("适用用户")]),i("div",[i("el-radio-group",{attrs:{size:"medium"},model:{value:t.discount.user_type,callback:function(e){t.$set(t.discount,"user_type",e)},expression:"discount.user_type"}},[i("el-radio-button",{attrs:{label:"all"}},[t._v("全部类型用户")]),i("el-radio-button",{attrs:{label:"normal"}},[t._v("普通用户")]),i("el-radio-button",{attrs:{label:"vip"}},[t._v("VIP会员")])],1)],1)]),i("div",{staticClass:"sale-content-item"},[i("div",[t._v("活动类型")]),i("div",[i("el-radio-group",{attrs:{size:"medium"},model:{value:t.discount.discount_type_code,callback:function(e){t.$set(t.discount,"discount_type_code",e)},expression:"discount.discount_type_code"}},[i("el-radio-button",{attrs:{label:"price_minus"}},[t._v("满元减")]),i("el-radio-button",{attrs:{label:"price_discount"}},[t._v("满元折")]),i("el-radio-button",{attrs:{label:"piece_minus"}},[t._v("满件减")]),i("el-radio-button",{attrs:{label:"piece_discount"}},[t._v("满件折")])],1)],1)]),i("div",{staticClass:"sale-content-item"},[i("div",[t._v("活动商品")]),i("div",[i("div",{staticStyle:{margin:"20px 0"}},[i("el-button",{attrs:{type:"primary",size:"small",disabled:t.isAll},on:{click:t.selectItems}},[t._v("添加商品")]),i("el-checkbox",{staticStyle:{"margin-left":"10px"},attrs:{size:"small"},on:{change:t.selectAll},model:{value:t.isAll,callback:function(e){t.isAll=e},expression:"isAll"}},[t._v("选择全部商品")])],1),i("div",{staticClass:"discount-items"},[i("div",{staticStyle:{"margin-bottom":"6px"}},[t._v("已选商品：")]),t.isAll?i("div",[t._v("全部商品")]):t._e(),0!==t.discount.items.length||t.isAll?t._e():i("div",[t._v("暂无商品")]),0!==t.discount.items.length?i("div",[i("span",[t._v(t._s(t.discount.items.length)+" 个商品")]),i("el-button",{staticStyle:{"margin-left":"15px"},attrs:{size:"medium",type:"text"},on:{click:function(e){t.checkVisible=!0}}},[t._v("修改商品")])],1):t._e()])])]),i("div",{staticClass:"sale-content-item"},[i("div",[t._v("活动优惠")]),i("div",[t._l(t.discount.rules,(function(e,s){return i("div",{key:s,staticClass:"discount-rule-block"},[i("div",{staticClass:"rule-block-header"},[i("strong",[t._v("优惠 "+t._s(s+1))]),i("el-button",{staticStyle:{float:"right",position:"relative",top:"-8px"},attrs:{type:"text",size:"medium"},on:{click:function(e){return t.delRule(s)}}},[t._v("删除优惠")])],1),i("div",[i("div",{staticClass:"rule-content-header"},[t._v("优惠条件")]),i("div",[i("span",[t._v("单笔订单买满 ")]),i("el-input-number",{attrs:{min:1,precision:0,size:"small","controls-position":"right"},model:{value:e.condition,callback:function(i){t.$set(e,"condition",i)},expression:"rule.condition"}}),i("span",[t._v(" "+t._s(-1!==t.discount.discount_type_code.indexOf("price")?"元":"件"))])],1),i("div",{staticClass:"rule-content-header",staticStyle:{"margin-top":"30px"}},[t._v("优惠内容")]),i("div",[i("span",[t._v(t._s(-1!==t.discount.discount_type_code.indexOf("minus")?"减":"打")+" ")]),-1!==t.discount.discount_type_code.indexOf("minus")?i("el-input-number",{attrs:{min:1,precision:2,size:"small","controls-position":"right"},model:{value:e.value,callback:function(i){t.$set(e,"value",i)},expression:"rule.value"}}):t._e(),-1!==t.discount.discount_type_code.indexOf("discount")?i("el-input-number",{attrs:{min:1,max:10,precision:1,size:"small","controls-position":"right"},model:{value:e.value,callback:function(i){t.$set(e,"value",i)},expression:"rule.value"}}):t._e(),i("span",[t._v(" "+t._s(-1!==t.discount.discount_type_code.indexOf("minus")?"元":"折"))]),0===s?i("el-checkbox",{staticStyle:{"margin-left":"30px"},on:{change:function(e){return t.changeLimit(e)}},model:{value:e.noLimit,callback:function(i){t.$set(e,"noLimit",i)},expression:"rule.noLimit"}},[t._v("上不封顶")]):t._e()],1)])])})),t.discount.rules.length<3?i("div",[i("el-button",{attrs:{type:"text",disabled:t.discount.rules[0].noLimit},on:{click:t.addRule}},[t._v("添加优惠等级")])],1):t._e()],2)])]),i("item-dialog",{attrs:{Visible:t.itemVisible,Current:t.current_items},on:{confirm:t.confirmItems,close:t.closeItems}}),i("el-dialog",{attrs:{visible:t.checkVisible,title:"修改商品",width:"800px"}},[t._l(t.discount.items,(function(e,s){return i("div",{key:s,staticClass:"check-item-list"},[i("el-image",{staticStyle:{width:"50px",height:"50px"},attrs:{src:e.img,fit:"scale-down"}}),i("div",{staticStyle:{width:"calc(100% - 320px)",margin:"0 10px"}},[i("span",{staticClass:"item-tag",class:{"is-sale":e.on_sale}},[t._v(t._s(e.on_sale?"上架":"下架"))]),t._v(t._s(e.product_title))]),i("div",{staticStyle:{width:"100px"}},[t._v("¥ "+t._s(e.price))]),i("div",{staticStyle:{width:"100px"}},[t._v("库存："+t._s(e.stock))]),i("div",{staticStyle:{width:"50px"}},[i("el-button",{attrs:{type:"text",size:"medium"},on:{click:function(e){return t.discount.items.splice(s,1)}}},[t._v("删除")])],1)],1)})),i("div",{staticStyle:{"text-align":"center"},attrs:{slot:"footer"},slot:"footer"},[i("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(e){t.checkVisible=!1}}},[t._v("确认")])],1)],2)],1)},n=[],c=(i("d81d"),i("a434"),i("d483")),l={components:{ItemDialog:c["a"]},data:function(){return{discount:{discount_name:"",discount_desc:"",start_time:"",end_time:"",discount_type_code:"price_minus",items:[],rules:[{level:1,condition:1,value:1,noLimit:!1}],status:"",user_type:"all"},datepicker:"",isAll:!1,itemVisible:!1,current_items:[],checkVisible:!1}},methods:{selectItems:function(){var t=this;this.current_items=[],this.discount.items.map((function(e){t.current_items.push(e.id)})),this.itemVisible=!0},closeItems:function(){this.itemVisible=!1},confirmItems:function(t){var e=this;t.map((function(t){e.discount.items.push(t)})),this.itemVisible=!1},selectAll:function(){this.discount.items=[]},addRule:function(){if(3!==this.discount.rules.length){var t={level:this.discount.rules.length,condition:0,value:0};this.discount.rules.push(t)}else this.$message.warning("最多只能添加3级优惠")},delRule:function(t){1!==this.discount.rules.length?this.discount.rules.splice(t,1):this.$message.warning("至少要有1级优惠")},changeLimit:function(t){if(t&&1!==this.discount.rules.length){var e=this.discount.rules[0];this.discount.rules=[],this.discount.rules.push(e)}}}},a=l,o=(i("947d"),i("2877")),r=Object(o["a"])(a,s,n,!1,null,"07e3bbf2",null);e["default"]=r.exports},"26ed":function(t,e,i){},8418:function(t,e,i){"use strict";var s=i("c04e"),n=i("9bf2"),c=i("5c6c");t.exports=function(t,e,i){var l=s(e);l in t?n.f(t,l,c(0,i)):t[l]=i}},"947d":function(t,e,i){"use strict";var s=i("26ed"),n=i.n(s);n.a},"991f":function(t,e,i){"use strict";var s=i("d5ff"),n=i.n(s);n.a},a434:function(t,e,i){"use strict";var s=i("23e7"),n=i("23cb"),c=i("a691"),l=i("50c4"),a=i("7b0b"),o=i("65f0"),r=i("8418"),d=i("1dde"),u=i("ae40"),p=d("splice"),m=u("splice",{ACCESSORS:!0,0:0,1:2}),v=Math.max,h=Math.min,_=9007199254740991,f="Maximum allowed length exceeded";s({target:"Array",proto:!0,forced:!p||!m},{splice:function(t,e){var i,s,d,u,p,m,g=a(this),b=l(g.length),y=n(t,b),x=arguments.length;if(0===x?i=s=0:1===x?(i=0,s=b-y):(i=x-2,s=h(v(c(e),0),b-y)),b+i-s>_)throw TypeError(f);for(d=o(g,s),u=0;u<s;u++)p=y+u,p in g&&r(d,u,g[p]);if(d.length=s,i<s){for(u=y;u<b-s;u++)p=u+s,m=u+i,p in g?g[m]=g[p]:delete g[m];for(u=b;u>b-s+i;u--)delete g[u-1]}else if(i>s)for(u=b-s;u>y;u--)p=u+s-1,m=u+i-1,p in g?g[m]=g[p]:delete g[m];for(u=0;u<i;u++)g[u+y]=arguments[u+2];return g.length=b-s+i,d}})},c4c8:function(t,e,i){"use strict";i.d(e,"e",(function(){return n})),i.d(e,"d",(function(){return c})),i.d(e,"a",(function(){return l})),i.d(e,"c",(function(){return a})),i.d(e,"b",(function(){return o}));var s=i("b775");function n(t){return Object(s["a"])({url:"product",method:"get",params:t})}function c(t){return Object(s["a"])({url:"product/"+t,method:"get"})}function l(t){return Object(s["a"])({url:"product",method:"post",data:t})}function a(t,e){return Object(s["a"])({url:"product/"+e,method:"put",data:t})}function o(t){return Object(s["a"])({url:"product/"+t,method:"delete"})}},d483:function(t,e,i){"use strict";var s=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("el-dialog",{attrs:{visible:t.Visible,title:"选择商品","before-close":t.close,width:"80%"}},[i("div",[i("el-input",{staticStyle:{width:"calc(100% - 110px)","margin-right":"10px"},attrs:{placeholder:"请输入商品名称搜索"},model:{value:t.query.name,callback:function(e){t.$set(t.query,"name",e)},expression:"query.name"}},[i("el-button",{attrs:{slot:"append"},on:{click:function(e){return t.search("search")}},slot:"append"},[t._v("搜索")])],1),i("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.search("all")}}},[t._v("查看全部")])],1),i("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}]},[0===t.items.length?i("div",{staticClass:"loading-placeholder"},[t._v("暂无结果")]):t._e(),i("div",{staticClass:"item-dialog-header"},[i("div",{staticStyle:{width:"80px"}},[t._v("图片")]),i("div",{staticStyle:{width:"calc(100% - 330px)"}},[t._v("商品标题")]),i("div",{staticStyle:{width:"100px"}},[t._v("售价")]),i("div",{staticStyle:{width:"50px"}},[t._v("上下架")]),i("div",{staticStyle:{width:"50px"}},[t._v("操作")])]),t._l(t.items,(function(e,s){return i("div",{key:s,staticClass:"item-dialog-item",class:{"is-select":-1!==t.selectId.indexOf(e.id)||-1!==t.Current.indexOf(e.id)}},[i("el-image",{staticStyle:{width:"80px",height:"80px"},attrs:{src:e.img}}),i("div",{staticStyle:{width:"calc(100% - 330px)"}},[t._v(t._s(e.product_title))]),i("div",{staticStyle:{width:"100px"}},[t._v("¥ "),i("strong",[t._v(t._s(e.price))])]),i("div",{staticStyle:{width:"50px"}},[t._v(t._s(e.on_sale?"上架":"下架"))]),i("div",{staticStyle:{width:"50px"}},[-1!==t.Current.indexOf(e.id)?i("span",[t._v("已选择")]):i("el-button",{staticStyle:{cursor:"pointer"},attrs:{type:"text",size:"mini"},on:{click:function(i){return t.changeSelect(e)}}},[t._v(t._s(-1===t.selectId.indexOf(e.id)?"选择":"移除"))])],1)],1)}))],2),i("el-pagination",{staticStyle:{"margin-top":"20px","text-align":"center"},attrs:{"current-page":t.query.page,"page-size":t.query.pageSize,total:t.total,layout:"total, prev, pager, next, jumper"},on:{"current-change":t.handleCurrentChange}}),i("div",{staticStyle:{"text-align":"center"},attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:t.close}},[t._v("取消")]),i("el-button",{attrs:{type:"primary"},on:{click:t.confirm}},[t._v("确定")])],1)],1)},n=[],c=(i("c975"),i("a434"),i("b0c0"),i("c4c8")),l={props:{Visible:Boolean,Current:Array},data:function(){return{loading:!1,items:[],total:0,query:{page:1,pageSize:15,name:""},selectId:[],selectItem:[]}},methods:{getItems:function(){var t=this;this.loading=!0,Object(c["e"])(this.query).then((function(e){t.items=e.data.body.data,t.total=e.data.body.page.total,t.loading=!1})).catch((function(){t.loading=!1}))},handleCurrentChange:function(t){this.query.page=t,this.getItems()},search:function(t){"all"===t&&(this.query.name=""),this.query.page=1,this.getItems()},changeSelect:function(t){var e=this.selectId.indexOf(t.id);-1===e?(this.selectId.push(t.id),this.selectItem.push(t)):(this.selectId.splice(e,1),this.selectItem.splice(e,1))},close:function(){this.$emit("close")},confirm:function(){0!==this.selectId.length?this.$emit("confirm",this.selectItem):this.$message.warning("请先选择商品")}},watch:{Visible:{deep:!0,handler:function(){this.Visible&&(this.selectId=[],this.selectItem=[],this.getItems())}}}},a=l,o=(i("991f"),i("2877")),r=Object(o["a"])(a,s,n,!1,null,"5e94a496",null);e["a"]=r.exports},d5ff:function(t,e,i){}}]);