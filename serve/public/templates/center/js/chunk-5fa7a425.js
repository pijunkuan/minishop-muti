(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-5fa7a425"],{5146:function(t,e,s){},"572f":function(t,e,s){"use strict";s.r(e);var i=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("div",{staticClass:"order-top-button"},[s("div",{staticStyle:{width:"80px"}},[s("el-button",{attrs:{size:"small"},on:{click:function(e){return t.$router.go(-1)}}},[t._v("返回")])],1),s("div",{class:{"is-refund":t.refund_reason},staticStyle:{width:"calc(100% - 280px)","font-weight":"500"}},[s("span",[t._v(t._s("closed"!==t.status?t.status_value:t.refund_status_value?t.refund_status_value:t.status_value))]),t.refund_reason?s("span",{staticStyle:{"margin-left":"15px"}},[t._v(t._s(t.refund_reason))]):t._e()]),s("div",{staticStyle:{width:"200px"}},["pending"===t.status?s("el-button",{attrs:{size:"small",type:"info"},on:{click:t.closedOrder}},[t._v("关闭订单")]):t._e(),"partial"!==t.status&&"processing"!==t.status||t.refund_status?t._e():s("el-button",{attrs:{type:"primary",size:"small"},on:{click:t.toSend}},[t._v("发货")]),-1===["processing","sent","partial","success"].indexOf(t.status)||t.refund_status?t._e():s("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(e){return t.refundOrder("refunded")}}},[t._v("退单")]),"refunding"===t.refund_status?s("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(e){return t.refundOrder("refunded")}}},[t._v("同意退单")]):t._e(),"refunding"===t.refund_status?s("el-button",{attrs:{size:"small",type:"danger"},on:{click:function(e){return t.refundOrder("refund_refuse")}}},[t._v("拒绝退单")]):t._e(),"pending"!==t.status&&"refunding"!==t.refund_status?s("el-button",{attrs:{size:"small",disabled:!(t.payment&&"cash"!==t.payment.payment_method&&t.payment.pay_at),type:"primary"},on:{click:t.toReturnMoney}},[t._v("退款")]):t._e()],1)]),s("div",{staticClass:"order-top",staticStyle:{width:"calc(100% - 2px)"}},[s("el-steps",{attrs:{active:t.status_active,"finish-status":"cancel"===t.status||"closed"===t.status||"refunded"===t.status?"wait":"success",simple:""}},t._l(t.status_processes,(function(t,e){return s("el-step",{key:e,attrs:{title:t.value}})})),1)],1),s("div",{staticClass:"order-contain"},[s("div",{staticClass:"order-main"},[1===t.suborders.length?s("div",[t._m(0),t._l(t.items,(function(e,i){return s("div",{key:i,staticClass:"order_items"},[s("div",{staticClass:"order_items_img"},[s("el-image",{staticStyle:{width:"60px",height:"60px"},attrs:{src:e.thumbnail,fit:"contain"}})],1),s("div",{staticClass:"order_items_info",staticStyle:{width:"calc(100% - 200px)"}},[s("div",[t._v(t._s(e.product_title))]),s("div",{staticClass:"sub-title"},[t._v("规格："+t._s(e.variant_title))])]),s("div",{staticClass:"order_items_quantity",staticStyle:{width:"120px"}},[s("div",[t._v("¥ "),s("strong",[t._v(t._s(e.price))]),t._v(" x "),s("strong",[t._v(t._s(e.quantity))])]),s("div",[t._v("共 ¥ "+t._s(e.total))])])])})),s("div",{staticClass:"order-price-list"},[s("div",[s("div",[t._v("商品总计：")]),s("div",[t._v("¥ "+t._s(t.items_amount))])]),s("div",[s("div",[t._v("运费总计：")]),s("div",[t._v("¥ "+t._s(t.shipments_amount))])]),s("div",[s("div",[t._v("优惠总计：")]),s("div",[t._v("-¥ "+t._s(t.discounts_amount))])]),s("div",[s("div",[t._v("订单总计：")]),t.ori_amount==t.amount?s("div",{staticClass:"order-price"},[t._v("¥ "),s("strong",{staticStyle:{"font-size":"16px"}},[t._v(t._s(t.amount))])]):s("div",[s("div",{staticStyle:{"text-decoration":"line-through"}},[t._v("¥ "+t._s(t.ori_amount))]),s("div",{staticClass:"order-price"},[t._v("¥ "),s("strong",{staticStyle:{"font-size":"16px"}},[t._v(t._s(t.amount))])])])]),"pending"==t.status?s("div",[s("el-button",{staticStyle:{"text-align":"right",padding:"5px 10px"},attrs:{type:"text"},on:{click:t.updatePriceOrder}},[t._v("修改价格")])],1):t._e()])],2):t._e(),1!==t.suborders.length?s("div",[t._m(1),t._l(t.suborders,(function(e,i){return s("div",{key:i,staticStyle:{padding:"5px","background-color":"#fff"}},[s("div",{staticClass:"order_title"},[s("span",[t._v("物流 "+t._s(i+1))]),s("span",{staticStyle:{"margin-left":"15px"}},[t._v(t._s(e.shipment_name))]),s("span",{staticStyle:{"margin-left":"15px"}},[t._v("¥ "+t._s(e.shipments_amount))])]),t._l(e.items,(function(e,i){return s("div",{key:"s"+i,staticClass:"order_items"},[s("div",{staticClass:"order_items_img"},[s("el-image",{staticStyle:{height:"60px",width:"60px"},attrs:{src:e.thumbnail}})],1),s("div",{staticClass:"order_items_info",staticStyle:{width:"calc(100% - 200px)"}},[s("div",[t._v(t._s(e.product_title))]),s("div",{staticClass:"sub-title"},[t._v("规格："+t._s(e.variant_title))])]),s("div",{staticClass:"order_items_quantity",staticStyle:{width:"120px"}},[s("div",[t._v("¥ "),s("strong",[t._v(t._s(e.price))]),t._v(" x "),s("strong",[t._v(t._s(e.quantity))])]),s("div",[t._v("共 ¥ "+t._s(e.total))])])])}))],2)})),s("div",{staticClass:"order-price-list"},[s("div",[s("div",[t._v("商品总计：")]),s("div",[t._v("¥ "+t._s(t.items_amount))])]),s("div",[s("div",[t._v("运费总计：")]),s("div",[t._v("¥ "+t._s(t.shipments_amount))])]),s("div",[s("div",[t._v("优惠总计：")]),s("div",[t._v("-¥ "+t._s(t.discounts_amount))])]),s("div",[s("div",[t._v("订单总计：")]),t.ori_amount==t.amount?s("div",{staticClass:"order-price"},[t._v("¥ "),s("strong",{staticStyle:{"font-size":"16px"}},[t._v(t._s(t.amount))])]):s("div",[s("div",{staticStyle:{"text-decoration":"line-through"}},[t._v("¥ "+t._s(t.ori_amount))]),s("div",{staticClass:"order-price"},[t._v("¥ "),s("strong",{staticStyle:{"font-size":"16px"}},[t._v(t._s(t.amount))])])])]),"pending"==t.status?s("div",[s("el-button",{staticStyle:{"text-align":"right",padding:"5px 10px"},attrs:{type:"text"},on:{click:t.updatePriceOrder}},[t._v("修改价格")])],1):t._e()])],2):t._e(),s("div",{staticClass:"order-remark"},[t._m(2),s("div",{staticStyle:{padding:"10px","background-color":"#fff","min-height":"50px","border-radius":"0 0 5px 5px"}},[t._v(t._s(t.remark?t.remark:"暂无"))])]),s("div",[s("div",{staticClass:"order-block-title"},[s("strong",[t._v("员工备注")]),s("span",{staticClass:"order-block-button",on:{click:t.addTips}},[t._v("添加备注")])]),0===t.tips.length?s("div",{staticStyle:{padding:"10px","background-color":"#fff","min-height":"50px","border-radius":"0 0 5px 5px"}},[t._v("暂无员工备注")]):t._e(),0!==t.tips.length?s("el-steps",{staticStyle:{"border-radius":"0 0 5px 5px","background-color":"#fff",padding:"10px"},attrs:{direction:"vertical",space:80}},t._l(t.tips,(function(e,i){return s("el-step",{key:i,attrs:{status:"finish"}},[s("div",{attrs:{slot:"description"},slot:"description"},[t._v(t._s(e.created_at))]),s("div",{attrs:{slot:"title"},slot:"title"},[t._v(t._s(e.tip))])])})),1):t._e()],1)]),s("div",{staticClass:"order-subside"},[s("div",{staticClass:"order-subside-card"},[t._m(3),s("div",{staticClass:"order-block-content"},[s("div",[s("div",[t._v("订单编号：")]),s("div",{staticClass:"user-name"},[t._v(t._s(t.no))])]),s("div",[s("div",[t._v("支付方式：")]),s("div",[t._v(t._s(t.payment?t.payment.payment_method_value:"-"))])]),s("div",[s("div",[t._v("支付时间：")]),s("div",[t._v(t._s(t.payment?t.payment.pay_at:"-"))])])])]),s("div",{staticClass:"order-subside-card"},[t._m(4),s("div",{staticClass:"order-block-content"},[s("div",[s("div",[t._v("用户名：")]),s("div",{staticClass:"user-name"},[t._v(t._s(t.customer.username))])]),s("div",[s("div",[t._v("手机号：")]),s("div",[t._v(t._s(t.customer.mobile))])])])]),s("div",{staticClass:"order-subside-card"},[t._m(5),s("div",{staticClass:"order-block-content"},[s("div",[s("div",[t._v("姓名：")]),s("div",{staticClass:"user-name"},[t._v(t._s(t.address.name))])]),s("div",[s("div",[t._v("地址：")]),s("div",[t._v(t._s(t.address.address))])]),s("div",[s("div",[t._v("电话：")]),s("div",[t._v(t._s(t.address.mobile))])]),s("div",[s("div",[t._v("邮编：")]),s("div",[t._v(t._s(t.address.zip))])])])]),s("div",{staticClass:"order-subside-card"},[t._m(6),0!==t.shipments.length?s("div",{staticStyle:{padding:"10px","background-color":"#fff"}},[s("el-collapse",t._l(t.shipments,(function(e,i){return s("el-collapse-item",{key:i,attrs:{title:"运单 "+(i+1)+" : "+e.shipment_no,name:i}},[s("div",[s("div",{staticStyle:{display:"inline-block",width:"70px"}},[t._v("运输方式：")]),s("div",{staticStyle:{display:"inline-block"}},[t._v(t._s(e.shipment_company))])]),s("div",[s("div",{staticStyle:{display:"inline-block",width:"70px"}},[t._v("运单号：")]),s("div",{staticStyle:{display:"inline-block"}},[t._v(t._s(e.shipment_no))])]),s("div",[s("ul",{staticClass:"shipment-item"},t._l(e.items,(function(e,i){return s("li",{key:i},[s("span",[s("strong",[t._v(t._s(e.product_title))])]),s("span",{staticStyle:{"margin-left":"10px"}},[t._v("规格："+t._s(e.variant_title))]),s("span",{staticStyle:{"margin-left":"20px"}},[t._v(" x "+t._s(e.quantity))])])})),0)])])})),1)],1):s("div",{staticStyle:{padding:"10px","background-color":"#fff","min-height":"50px"}},[t._v("暂无配送信息")])])])]),s("order-send",{attrs:{Visible:t.sendDialogShow,pendItems:t.pend_items},on:{close:function(e){t.sendDialogShow=!1},confirm:t.sendConfirm}}),s("order-refund",{attrs:{Visible:t.refundVisible},on:{close:function(e){t.refundVisible=!1},confirm:t.refundConfirm}})],1)},n=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"order-block-title"},[s("strong",[t._v("商品详情")])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"order-block-title"},[s("strong",[t._v("商品详情")])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"order-block-title"},[s("strong",[t._v("客户备注")])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"order-block-title"},[s("strong",[t._v("订单信息")])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"order-block-title"},[s("strong",[t._v("客户信息")])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"order-block-title"},[s("strong",[t._v("配送信息")])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"order-block-title"},[s("strong",[t._v("配送列表")])])}],a=(s("4de4"),s("d81d"),s("b0c0"),s("f8b7")),r=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("el-dialog",{attrs:{visible:t.Visible,title:"退款",width:"650px","before-close":t.close}},[s("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}]},[s("el-form",{attrs:{"label-width":"100px"}},[s("el-form-item",{attrs:{label:"订单金额"}},[s("div",[t._v("¥ "),s("strong",[t._v(t._s(t.refund_info.order_amount))])])]),1*t.refund_info.order_amount>t.refund_info.refund_amount_rest+t.refund_info.refund_amount_success?s("el-form-item",{attrs:{label:"已退款金额"}},[s("div",[s("span",{staticClass:"sub-title"},[t._v("正在退款 ")]),s("span",[t._v("¥ "),s("strong",[t._v(t._s(t.refund_info.refund_amount_pending))])])]),s("div",[s("span",{staticClass:"sub-title"},[t._v("成功退款 ")]),s("span",[t._v("¥ "),s("strong",[t._v(t._s(t.refund_info.refund_amount_success))])])]),s("div",[s("el-button",{attrs:{type:"text"},on:{click:function(e){t.seeDetail=!t.seeDetail}}},[t._v(t._s(t.seeDetail?"收起":"查看")+"退款记录")])],1),t.seeDetail?s("div",{staticClass:"detail-items"},[s("div",{staticClass:"detail-list detail-header"},[s("div",{staticStyle:{width:"100px"}},[t._v("金额")]),s("div",{staticStyle:{width:"150px"}},[t._v("时间")]),s("div",{staticStyle:{width:"calc(100% - 335px)"}},[t._v("备注")]),s("div",{staticStyle:{width:"60px"}},[t._v("状态")])]),t._l(t.refund_info.refund_record_list,(function(e,i){return s("div",{key:i,staticClass:"detail-list"},[s("div",{staticStyle:{width:"100px"}},[t._v("¥ "+t._s(e.amount))]),s("div",{staticStyle:{width:"150px"}},[t._v(t._s(e.created_at))]),s("div",{staticStyle:{width:"calc(100% - 335px)"}},[t._v(t._s(e.content))]),s("div",{staticStyle:{width:"60px"}},[t._v(t._s(e.status_value))])])}))],2):t._e()]):t._e(),1*t.refund_info.order_amount>t.refund_info.refund_amount_rest+t.refund_info.refund_amount_success?s("el-form-item",{attrs:{label:"剩余退款金额"}},[s("div",[t._v("¥ "),s("strong",[t._v(t._s(t.refund_info.refund_amount_rest))])])]):t._e(),0!==t.refund_info.refund_amount_rest?s("el-form-item",{attrs:{label:"填写退款金额"}},[s("el-input-number",{attrs:{min:.01,max:t.refund_info.refund_amount_rest,precision:2},model:{value:t.refund.amount,callback:function(e){t.$set(t.refund,"amount",e)},expression:"refund.amount"}}),s("div",{staticStyle:{cursor:"pointer",display:"inline-block","margin-left":"10px"},on:{click:function(e){t.refund.amount=t.refund_info.refund_amount_rest}}},[t._v("全额退款")])],1):t._e(),s("el-form-item",{attrs:{label:"退款备注"}},[s("el-input",{model:{value:t.refund.content,callback:function(e){t.$set(t.refund,"content",e)},expression:"refund.content"}})],1)],1)],1),s("div",{attrs:{slot:"footer"},slot:"footer"},[s("el-button",{on:{click:t.close}},[t._v("取消")]),s("el-button",{attrs:{type:"primary",loading:t.btnLoading},on:{click:t.confirm}},[t._v("确定")])],1)])},o=[],d={props:{Visible:Boolean},data:function(){return{refund_info:{order_amount:null,refund_amount_pending:null,refund_amount_rest:null,refund_amount_success:null,refund_record_list:[]},loading:!1,refund:{amount:.01,content:""},btnLoading:!1,seeDetail:!1}},methods:{getRefund:function(){var t=this;this.loading=!0,Object(a["g"])(this.$route.query.id).then((function(e){t.refund_info=e.data.body,t.loading=!1})).catch((function(){t.loading=!1}))},reset:function(){this.refund_info={order_amount:null,refund_amount_pending:null,refund_amount_rest:null,refund_amount_success:null,refund_record_list:[]},this.refund={amount:.01,content:""},this.seeDetail=!1},close:function(){this.reset(),this.$emit("close")},confirm:function(){var t=this;this.btnLoading=!0,Object(a["b"])(this.$route.query.id,this.refund).then((function(){t.$message.success("退款成功"),t.btnLoading=!1,t.reset(),t.$emit("confirm")})).catch((function(e){t.$message.warning({message:e.response.data.message,duration:4e3}),t.btnLoading=!1}))}},watch:{Visible:{deep:!0,handler:function(){this.Visible&&this.getRefund()}}}},u=d,c=(s("a65b"),s("ea76"),s("2877")),l=Object(c["a"])(u,r,o,!1,null,"4de0b256",null),_=l.exports,v=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("el-dialog",{attrs:{title:"发货",visible:t.Visible,width:"600px","before-close":t.close}},[s("div",{staticClass:"send-content"},[s("div",{staticClass:"send-header"},[t._v("待发货商品")]),s("div",{staticClass:"select-header"},[s("div",{staticStyle:{width:"80px"}},[t._v("图片")]),s("div",{staticStyle:{width:"calc(100% - 230px)","margin-right":"20px"}},[t._v("名称")]),s("div",{staticStyle:{width:"130px"}},[t._v("数量")])]),t._l(t.pendItems,(function(e,i){return s("div",{key:i},[s("el-checkbox",{staticClass:"select-item",attrs:{label:e},model:{value:t.selected_items,callback:function(e){t.selected_items=e},expression:"selected_items"}},[s("div",{staticStyle:{width:"80px"}},[s("el-image",{staticStyle:{width:"60px",height:"60px"},attrs:{src:e.thumbnail}},[s("div",{staticClass:"image-placeholder",attrs:{slot:"placeholder"},slot:"placeholder"},[s("i",{staticClass:"iconfont icontupian1"})]),s("div",{staticClass:"image-placeholder",attrs:{slot:"error"},slot:"error"},[s("i",{staticClass:"iconfont icontupian1"})])])],1),s("div",{staticStyle:{width:"calc(100% - 230px)","margin-right":"10px"}},[s("div",[t._v(t._s(e.product_title))]),s("div",[t._v(t._s(e.variant_title))])])]),s("div",{staticStyle:{width:"130px",display:"inline-block"}},[s("el-input-number",{attrs:{min:1,max:1*e.quantity,precision:0,size:"mini"},model:{value:e.amount,callback:function(s){t.$set(e,"amount",s)},expression:"item.amount"}})],1)],1)}))],2),s("el-form",{attrs:{"label-width":"68px"}},[s("el-form-item",{attrs:{label:"运输公司"}},[s("el-input",{model:{value:t.sendInfo.shipment_company,callback:function(e){t.$set(t.sendInfo,"shipment_company",e)},expression:"sendInfo.shipment_company"}})],1),s("el-form-item",{attrs:{label:"运单号"}},[s("el-input",{model:{value:t.sendInfo.shipment_no,callback:function(e){t.$set(t.sendInfo,"shipment_no",e)},expression:"sendInfo.shipment_no"}})],1),s("div",{staticStyle:{"text-align":"right"}},[s("el-button",{on:{click:t.close}},[t._v("取消")]),s("el-button",{attrs:{type:"primary",loading:t.btnLoading},on:{click:t.sendOrder}},[t._v("确认发货")])],1)],1)],1)},f=[],m={props:{Visible:Boolean,pendItems:Array},data:function(){return{selected_items:[],sendInfo:{shipment_no:"",shipment_company:""},btnLoading:!1}},methods:{sendOrder:function(){var t=this;if(0!==this.selected_items.length)if(this.sendInfo.shipment_company)if(this.sendInfo.shipment_no){this.btnLoading=!0;var e=[];this.selected_items.map((function(t){e.push({variant_id:t.variant_id,quantity:t.amount})})),this.sendInfo["items"]=e,Object(a["h"])(this.$route.query.id,this.sendInfo).then((function(){t.$message.success("发货成功"),t.$emit("confirm"),t.btnLoading=!1})).catch((function(){t.btnLoading=!1}))}else this.$message.warning("请填写运单号");else this.$message.warning("请填写运输公司");else this.$message.warning("请选择发货商品")},close:function(){this.$emit("close")}}},p=m,h=(s("ff47"),s("d953"),Object(c["a"])(p,v,f,!1,null,"1d0fceac",null)),g=h.exports,b={components:{OrderRefund:_,OrderSend:g},data:function(){return{id:null,no:null,customer:{},suborders:[],items:[],payment:null,address:{},shipments:[],items_amount:null,discounts_amount:null,shipments_amount:null,amount:null,ori_amount:null,status:null,status_value:null,refund_at:null,refund_status:null,refund_status_value:null,refund_reason:null,remark:null,tips:[],send_at:null,pay_at:null,success_at:null,created_at:null,status_active:0,status_processes:[],sendDialogShow:!1,pend_items:[],btnLoading:!1,refundVisible:!1}},beforeRouteLeave:function(t,e,s){"OrderList"===t.name?t.meta.keepAlive=!0:t.meta.keepAlive=!1,s()},methods:{getData:function(){var t=this;this.$loading(),Object(a["d"])(this.$route.query.id).then((function(e){t.$loading().close();var s=e.data.body;if(t.id=t.$route.query.id,t.no=s.no,t.customer=s.customer,t.suborders=s.suborders,t.items=[],t.suborders.map((function(e){e.items.map((function(e){t.items.push(e)}))})),t.payment=s.payment,t.address=s.address,t.shipments=s.shipments,t.items_amount=s.items_amount,t.discounts_amount=s.discounts_amount,t.shipments_amount=s.shipments_amount,t.amount=s.amount,t.ori_amount=s.ori_amount,t.status=s.status,t.status_value=s.status_value,t.refund_status=s.refund_status,t.refund_status_value=s.refund_status_value,t.refund_reason=s.refund_reason,t.refund_at=s.refund_at,t.remark=s.remark,t.tips=s.tips,t.send_at=s.send_at,t.pay_at=s.pay_at,t.success_at=s.success_at,t.created_at=s.created_at,s.refund_status)switch(s.refund_status){case"refunding":t.status_active=3,t.status_processes=[{value:"订单创建"},{value:"订单支付"},{value:"退单申请"},{value:"订单关闭"}];break;case"refunded":t.status_active=4,t.status_processes=[{value:"订单创建"},{value:"订单支付"},{value:"退单申请"},{value:"订单关闭"}];break}else switch(s.status){case"pending":t.status_active=1,t.status_processes=[{value:"订单创建"},{value:"订单支付"},{value:"配送中"},{value:"已完成"}];break;case"processing":t.status_active=2,t.status_processes=[{value:"订单创建"},{value:"订单支付"},{value:"配送中"},{value:"已完成"}];break;case"partial":case"sent":t.status_active=3,t.status_processes=[{value:"订单创建"},{value:"订单支付"},{value:"配送中"},{value:"已完成"}];break;case"success":t.status_active=4,t.status_processes=[{value:"订单创建"},{value:"订单支付"},{value:"配送中"},{value:"已完成"}];break;case"cancel":t.status_active=2,t.status_processes=[{value:"订单创建"},{value:"已取消"}];break;case"closed":t.status_active=2,t.status_processes=[{value:"订单创建"},{value:"已关闭"}];break}})).catch((function(){t.$message.warning("参数错误"),t.$router.push({name:"OrderList"}),t.$loading().close()}))},refundOrder:function(t){var e=this;this.$prompt("","",{title:"提示",message:"请输入"+("refunded"===t?"退单":"拒绝退单")+"理由",confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(s){var i=s.value;Object(a["i"])(e.id,{status:t,reason:i}).then((function(){e.$message.success("refunded"===t?"已成功退单":"退单已驳回"),e.getData()}))})).catch((function(){}))},closedOrder:function(){var t=this;this.$confirm("此操作将取消该订单, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){Object(a["i"])(t.id,{status:"cancel"}).then((function(){t.$message.success("关闭成功"),t.getData()}))})).catch((function(){t.$message({type:"info",message:"已取消"})}))},updatePriceOrder:function(){var t=this;this.$prompt("请输入价格","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(e){var s=e.value;Object(a["j"])(t.id,{amount:s}).then((function(){t.$message.success("修改成功"),t.getData()}))})).catch((function(){t.$message({type:"info",message:"已取消"})}))},toSend:function(){var t=this;this.selected_items=[],this.pend_items=[];var e=[];this.shipments.map((function(t){t.items.map((function(t){e.push(t)}))})),this.items.map((function(s){var i=e.filter((function(t){return t.variant_id===s.variant_id}));if(0===i.length){var n={product_title:s.product_title,variant_title:s.variant_title,variant_id:s.variant_id,amount:s.quantity,quantity:s.quantity};t.pend_items.push(n),t.selected_items.push(n)}else if(i[0].quantity!==s.quantity){var a={product_title:s.product_title,variant_title:s.variant_title,variant_id:s.variant_id,amount:s.quantity-i[0].quantity,quantity:s.quantity-i[0].quantity};t.pend_items.push(a),t.selected_items.push(a)}})),this.sendDialogShow=!0},sendConfirm:function(){this.sendDialogShow=!1,this.getData()},toReturnMoney:function(){"cash"!==this.payment.payment_method?this.refundVisible=!0:this.$message.warning("货到付款不支持线上退款")},refundConfirm:function(){this.refundVisible=!1,this.getData()},addTips:function(){var t=this;this.$prompt("填写订单备注","添加备注",{confirmButtonText:"提交",cancelButtonText:"取消"}).then((function(e){var s=e.value;Object(a["a"])(t.$route.query.id,{tip:s}).then((function(){t.$message.success("添加成功"),setTimeout((function(){t.$loading(),Object(a["e"])(t.$route.query.id).then((function(e){t.tips=e.data.body,t.$loading().close()})).catch((function(){t.$loading().close()}))}),500)}))}))}},created:function(){this.$route.query.id?this.getData():(this.$message.warning("参数错误"),this.$router.push({name:"OrderList"}))}},y=b,x=(s("aee3"),s("f98a"),Object(c["a"])(y,i,n,!1,null,"3b517ab0",null));e["default"]=x.exports},a65b:function(t,e,s){"use strict";var i=s("ccc3"),n=s.n(i);n.a},a9c7:function(t,e,s){},aee3:function(t,e,s){"use strict";var i=s("d6ed"),n=s.n(i);n.a},ccc3:function(t,e,s){},d6ed:function(t,e,s){},d953:function(t,e,s){"use strict";var i=s("fb4d"),n=s.n(i);n.a},ea76:function(t,e,s){"use strict";var i=s("f0cf"),n=s.n(i);n.a},f0cf:function(t,e,s){},f8b7:function(t,e,s){"use strict";s.d(e,"f",(function(){return n})),s.d(e,"d",(function(){return a})),s.d(e,"i",(function(){return r})),s.d(e,"j",(function(){return o})),s.d(e,"h",(function(){return d})),s.d(e,"g",(function(){return u})),s.d(e,"b",(function(){return c})),s.d(e,"a",(function(){return l})),s.d(e,"e",(function(){return _})),s.d(e,"c",(function(){return v}));var i=s("b775");function n(t){return Object(i["a"])({url:"order",method:"get",params:t})}function a(t){return Object(i["a"])({url:"order/"+t,method:"get"})}function r(t,e){return Object(i["a"])({url:"order/status/"+t,method:"put",data:e})}function o(t,e){return Object(i["a"])({url:"order/"+t,method:"put",data:e})}function d(t,e){return Object(i["a"])({url:"order/"+t+"/shipment",method:"post",data:e})}function u(t){return Object(i["a"])({url:"order/refund_record/"+t,method:"get"})}function c(t,e){return Object(i["a"])({url:"order/refund_record/"+t,method:"post",data:e})}function l(t,e){return Object(i["a"])({url:"order/"+t+"/tip",method:"post",data:e})}function _(t){return Object(i["a"])({url:"order/"+t+"/tip",method:"get"})}function v(t){return Object(i["a"])({url:"order/download",method:"post",data:t})}},f98a:function(t,e,s){"use strict";var i=s("a9c7"),n=s.n(i);n.a},fb4d:function(t,e,s){},ff47:function(t,e,s){"use strict";var i=s("5146"),n=s.n(i);n.a}}]);