(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-6becf830"],{1:function(e,t){},1159:function(e,t,i){},2:function(e,t){},3:function(e,t){},"396a":function(e,t,i){},6784:function(e,t,i){"use strict";var n=i("396a"),s=i.n(n);s.a},6991:function(e,t,i){},b029:function(e,t,i){"use strict";var n=i("f078"),s=i.n(n);s.a},b06c:function(e,t,i){"use strict";i.r(t);var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("div",{staticClass:"table-header"},[i("el-input",{staticClass:"input-with-select",attrs:{placeholder:"请输入商品名称搜索"},model:{value:e.query.name,callback:function(t){e.$set(e.query,"name",t)},expression:"query.name"}},[i("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:e.search},slot:"append"})],1),i("div",{staticClass:"table-header-button"},[i("el-button",{attrs:{type:"primary",size:"small",disabled:"免费版"===e.$store.getters.shop_level&&e.data.length>=20},on:{click:e.toAdd}},[e._v("单个商品新增")]),i("el-button",{attrs:{type:"primary",size:"small",disabled:"免费版"===e.$store.getters.shop_level&&e.data.length>=20},on:{click:function(t){e.addGroupVisible=!0}}},[e._v("批量新增")]),i("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(t){e.editGroupVisible=!0}}},[e._v("批量修改")]),i("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.visibleGroup}},[e._v("批量上下架")]),i("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.deleteGroup}},[e._v("批量删除")]),i("el-dropdown",{staticStyle:{"margin-left":"10px"}},[i("el-button",{attrs:{type:"primary",size:"small"}},[e._v("批量导出"),i("i",{staticClass:"el-icon-arrow-down",staticStyle:{"margin-left":"5px"}})]),i("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[i("el-dropdown-item",[i("div",{on:{click:e.toExport}},[e._v("导出选择")])]),i("el-dropdown-item",[i("div",{on:{click:e.toExportAll}},[e._v("导出全部")])])],1)],1)],1)],1),i("div",{staticStyle:{"background-color":"#fff","border-radius":"5px"}},[i("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"itemTable",staticClass:"product-table",attrs:{data:e.data,"header-row-class-name":"table-header-row",border:""},on:{"selection-change":e.handleSelect}},[i("el-table-column",{attrs:{type:"selection",align:"center"}}),i("el-table-column",{attrs:{prop:"img",label:"图片",width:"130px",align:"center"},scopedSlots:e._u([{key:"default",fn:function(e){return[i("el-image",{staticStyle:{width:"100px",height:"100px"},attrs:{src:e.row.img,fit:"scale-down"}})]}}])}),i("el-table-column",{attrs:{label:"商品名称","min-width":"200px"},scopedSlots:e._u([{key:"default",fn:function(t){return i("div",{},[i("span",{staticClass:"table-item-title",staticStyle:{cursor:"pointer"},on:{click:function(i){return e.toItem(t.row)}}},[e._v(e._s(t.row.product_title))]),i("span",{staticClass:"inline-btn",on:{click:function(i){return e.changeTitle(t.row)}}},[i("i",{staticClass:"iconfont iconbianji"})])])}}])}),i("el-table-column",{attrs:{label:"库存",prop:"stock"}}),i("el-table-column",{attrs:{label:"售价"},scopedSlots:e._u([{key:"default",fn:function(t){return i("div",{},[e._v("¥ "+e._s(t.row.price))])}}])}),i("el-table-column",{attrs:{prop:"on_sale",label:"上架",width:"70px"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.on_sale?i("el-tag",{attrs:{type:"success"}},[e._v("上架")]):i("el-tag",{attrs:{type:"info"}},[e._v("下架")])]}}])}),i("el-table-column",{attrs:{label:"操作",width:"150px"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(i){return e.changeVisible(t.row)}}},[e._v(e._s(t.row.on_sale?"下架":"上架"))]),i("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(i){return e.toDelete(t.row)}}},[e._v("删除")])]}}])})],1),i("el-pagination",{staticStyle:{"text-align":"center",padding:"40px 0"},attrs:{"current-page":e.query.page,"page-sizes":[15,30,50,100],"page-size":e.query.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1),i("progress-bar",{attrs:{Visible:e.progressShow,Title:e.progressTitle,Index:e.index,Total:e.selected.length}}),i("group-add",{attrs:{visible:e.addGroupVisible},on:{close:function(t){e.addGroupVisible=!1},reload:e.getData}}),i("group-edit",{attrs:{visible:e.editGroupVisible,selected:e.selected},on:{close:function(t){e.editGroupVisible=!1},reload:e.getData}})],1)},s=[],a=(i("d81d"),i("b0c0"),i("d3b7"),i("c4c8")),r=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("el-dialog",{attrs:{visible:e.Visible,title:e.Title,"close-on-click-modal":!1,"close-on-press-escape":!1,"show-close":!1}},[i("el-progress",{attrs:{"text-inside":!0,"stroke-width":20,percentage:e.percentage}}),i("div",{staticStyle:{"text-align":"right","margin-top":"20px"}},[e._v("已处理"),i("strong",[e._v(e._s(e.Index))]),e._v("条，共"),i("strong",[e._v(e._s(e.Total))]),e._v("条")])],1)},o=[],c=(i("a9e3"),i("b680"),{props:{Visible:Boolean,Title:String,Index:Number,Total:Number},data:function(){return{percentage:0}},watch:{Index:{deep:!0,immediate:!0,handler:function(){this.Total?this.percentage=1*(this.Index/this.Total*100).toFixed(2):this.percentage=0}}}}),l=c,d=i("2877"),u=Object(d["a"])(l,r,o,!1,null,null,null),h=u.exports,p=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("el-dialog",{attrs:{visible:e.visible,title:"批量添加商品","before-close":e.close}},[i("div",[e._v("还没有模版？"),i("el-button",{attrs:{type:"text"},on:{click:e.downloadTemplate}},[e._v("下载模版")])],1),i("div",{staticClass:"tip"},[i("div",[e._v("1、多SKU商品请务必保证商品名称一致（包含一致数量的空格、中英文标点、大小写等）")]),i("div",[e._v("2、商品分类请填写分类id，可在分类设置页面查询")]),i("div",[e._v("3、物流模版请填写模版id，可在物流模版设置页面查询")]),i("div",[e._v("4、上架情况请填写 1 - 代表上架；0 - 代表下架")])]),i("upload-excel",{attrs:{"on-success":e.excelSuccess}}),0!==e.data.length?i("div",[e._v(" 该文件包含"+e._s(e.data.length)+"条商品 ")]):e._e(),i("div",{staticStyle:{"text-align":"center"},attrs:{slot:"footer"},slot:"footer"},[i("el-button",{attrs:{type:"primary",size:"small",plain:""},on:{click:e.close}},[e._v(" 取消 ")]),i("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.confirm}},[e._v(" 确定 ")])],1)],1),i("progress-bar",{attrs:{Visible:e.progress,Title:"批量新增商品",Index:e.index,Total:e.data.length}})],1)},f=[],g=(i("4de4"),i("4160"),i("c975"),i("b64b"),i("159b"),function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("input",{ref:"excel-upload-input",staticClass:"excel-upload-input",attrs:{type:"file",accept:".xlsx, .xls, .csv"},on:{change:e.handleClick}}),i("div",{staticClass:"drop",on:{drop:e.handleDrop,dragover:e.handleDragover,dragenter:e.handleDragover}},[i("p",[e._v("将Excel文件拖拽到这里")]),i("el-button",{attrs:{loading:e.loading,size:"mini",type:"primary"},on:{click:e.handleUpload}},[e._v("点击打开文件夹")])],1)])}),m=[],v=i("1146"),_=i.n(v),b={props:{beforeUpload:Function,onSuccess:Function},data:function(){return{loading:!1,excelData:{header:null,results:null}}},methods:{generateData:function(e){var t=e.header,i=e.results;this.excelData.header=t,this.excelData.results=i,this.onSuccess&&this.onSuccess(this.excelData)},handleDrop:function(e){if(e.stopPropagation(),e.preventDefault(),!this.loading){var t=e.dataTransfer.files;if(1===t.length){var i=t[0];if(!this.isExcel(i))return this.$message.error("Only supports upload .xlsx, .xls, .csv suffix files"),!1;this.upload(i),e.stopPropagation(),e.preventDefault()}else this.$message.error("Only support uploading one file!")}},handleDragover:function(e){e.stopPropagation(),e.preventDefault(),e.dataTransfer.dropEffect="copy"},handleUpload:function(){this.$refs["excel-upload-input"].click()},handleClick:function(e){var t=e.target.files,i=t[0];i&&this.upload(i)},upload:function(e){if(this.$refs["excel-upload-input"].value=null,this.beforeUpload){var t=this.beforeUpload(e);t&&this.readerData(e)}else this.readerData(e)},readerData:function(e){var t=this;return this.loading=!0,new Promise((function(i){var n=new FileReader;n.onload=function(e){var n=e.target.result,s=_.a.read(n,{type:"array"}),a=s.SheetNames[0],r=s.Sheets[a],o=t.getHeaderRow(r),c=_.a.utils.sheet_to_json(r);t.generateData({header:o,results:c}),t.loading=!1,i()},n.readAsArrayBuffer(e)}))},getHeaderRow:function(e){var t,i=[],n=_.a.utils.decode_range(e["!ref"]),s=n.s.r;for(t=n.s.c;t<=n.e.c;++t){var a=e[_.a.utils.encode_cell({c:t,r:s})],r="UNKNOWN "+t;a&&a.t&&(r=_.a.utils.format_cell(a)),i.push(r)}return i},isExcel:function(e){return/\.(xlsx|xls|csv)$/.test(e.name)}}},x=b,w=(i("bc1f"),Object(d["a"])(x,g,m,!1,null,"363fc413",null)),y=w.exports,k={props:{visible:Boolean},components:{UploadExcel:y,ProgressBar:h},data:function(){return{data:[],headers:["商品名称(必填)","商品简介","商品分类","sku名称(必填)","sku编号","sku库存(必填)","sku重量","sku售价(必填)","sku原价","商品详情","物流模版(必填)","上架情况"],filterVal:["product_title","product_des","category","variant_title","variant_code","quantity","weight","price","ori_price","content","shipment_id","on_sale"],index:0,progress:!1,error:[],wrong:0,originalDoc:[]}},methods:{downloadTemplate:function(){var e=this,t=[],n=this.formatJson(this.filterVal,t);Promise.all([i.e("chunk-9a46517a"),i.e("chunk-2d0cc0b6")]).then(i.bind(null,"4bf8")).then((function(t){t.export_json_to_excel({header:e.headers,data:n,filename:"商品上传模版"})}))},formatJson:function(e,t){return t.map((function(t){return e.map((function(e){return t[e]}))}))},excelSuccess:function(e){var t=this,i=e.header,n=e.results,s=i.filter((function(e){return-1===t.headers.indexOf(e)}));s.length>1||1===s.length&&"错误报告"!==s[0]?this.$message.warning("检查到上传表格表头错误，请检查后重新上传"):this.setData(n)},setData:function(e){var t=this;if(0!==e.length){var i=e.filter((function(e){return!e["商品名称(必填)"]||!e["sku名称(必填)"]||!e["sku库存(必填)"]||!e["sku售价(必填)"]||!e["物流模版(必填)"]}));if(0===i.length){var n=[],s={},a={},r=["product_title","product_des","content","shipment_id","on_sale"];e.map((function(e){s["variant"]={},t.filterVal.map((function(i,n){a[i]=e[t.headers[n]],"category"===i?(s["categories"]=[],e[t.headers[n]]&&s.categories.push(e[t.headers[n]])):-1!==r.indexOf(i)?s[i]=e[t.headers[n]]:s.variant[i]=e[t.headers[n]]})),n.push(s),t.originalDoc.push(a),s={},a={}}));var o={},c={};n.forEach((function(e){var t=e.product_title,i=o[t]||{};i={product:{product_title:e.product_title,product_des:e.product_des,on_sale:e.on_sale,shipment_id:e.shipment_id},categories:e.categories,variants:[],content:e.content},o[t]=i})),n.forEach((function(e){var t=e.product_title,i=c[t]||[];i.push(e.variant),c[t]=i}));var l=Object.keys(o).map((function(e){return o[e]})),d=Object.keys(c).map((function(e){return c[e]}));l.forEach((function(e,t){e.variants=d[t]})),this.data=l}else this.$message.warning("上传文件部分必填项为空，请填写后重新上传")}else this.$message.warning("上传文件内容为空，请重新上传")},close:function(){this.data=[],this.$emit("close")},confirm:function(){this.progress=!0,this.index=0,this.toAdd()},toAdd:function(){var e=this;if(this.index===this.data.length)return this.index+=this.index,0!==this.wrong?(this.$message.warning("部分上传不成功，错误记录将自动下载，请修改后重新上传"),this.downloadWrong()):this.$message.success("上传完毕"),void setTimeout((function(){e.progress=!1,e.index=0,e.wrong=0,e.close(),e.$emit("reload")}),500);var t=this.data[this.index],i=this.data[this.index];Object(a["a"])(t).then((function(){e.index++,e.toAdd()})).catch((function(t){i["message"]=t.response.data.message,e.error.push(i),e.index++,e.wrong++,e.toAdd()}))},downloadWrong:function(){var e=this,t=this.headers;t.push("错误报告");var n=this.filterVal;n.push("message");var s=[],a={};this.originalDoc.map((function(t){a=t;var i=e.error.filter((function(e){return e.product.product_title===a.product_title}));0!==i.length&&(a["message"]=i[0].message,s.push(a),a={})}));var r=this.formatJson(n,s);Promise.all([i.e("chunk-9a46517a"),i.e("chunk-2d0cc0b6")]).then(i.bind(null,"4bf8")).then((function(e){e.export_json_to_excel({header:t,data:r,filename:"商品上传错误报告"})}))}}},T=k,D=(i("b029"),Object(d["a"])(T,p,f,!1,null,"01a80b1b",null)),$=D.exports,S=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("el-dialog",{attrs:{visible:e.visible,title:"批量修改商品","before-close":e.close}},[i("div",[e._v("没有下载过选中商品信息"),i("el-button",{attrs:{type:"text"},on:{click:e.toDownload}},[e._v("下载信息")])],1),i("div",{staticClass:"download-tip"},[e._v(e._s(e.isTip))]),i("div",{staticClass:"tip"},[i("div",[e._v("1、多SKU商品请务必保证商品名称一致（包含一致数量的空格、中英文标点、大小写等）")]),i("div",[e._v("2、商品分类请填写分类id，可在分类设置页面查询")]),i("div",[e._v("3、物流模版请填写模版id，可在物流模版设置页面查询")]),i("div",[e._v("4、上架情况请填写 1 - 代表上架；0 - 代表下架")])]),i("upload-excel",{attrs:{"on-success":e.excelSuccess}}),0!==e.data.length?i("div",[e._v(" 该文件包含"+e._s(e.data.length)+"条商品 ")]):e._e(),i("div",{staticStyle:{"text-align":"center"},attrs:{slot:"footer"},slot:"footer"},[i("el-button",{attrs:{type:"primary",size:"small",plain:""},on:{click:e.close}},[e._v(" 取消 ")]),i("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.confirm}},[e._v(" 确定 ")])],1)],1),i("progress-bar",{attrs:{Visible:e.progress,Title:"批量新增商品",Index:e.index,Total:e.data.length}})],1)},j=[],O={props:{visible:Boolean,selected:Array},components:{UploadExcel:y,ProgressBar:h},data:function(){return{data:[],headers:["商品ID(不可修改)","商品名称(必填)","商品简介","商品分类","sku名称(必填)","sku编号","sku库存(必填)","sku重量","sku售价(必填)","sku原价","商品详情","物流模版(必填)","上架情况"],filterVal:["id","product_title","product_des","category","variant_title","variant_code","quantity","weight","price","ori_price","content","shipment_id","on_sale"],index:0,progress:!1,error:[],wrong:0,originalDoc:[],isTip:"",items:[]}},methods:{toDownload:function(){0!==this.selected.length?(this.isTip="正在获取商品信息，请稍后",this.index=0,this.getItems()):this.$message.warning("请先选择商品")},getItems:function(){var e=this;if(this.index===this.selected.length)return this.isTip="信息获取完成，马上下载",this.index=0,setTimeout((function(){e.isTip=""}),1e3),void this.downloadTemplate();var t=this.selected[this.index];Object(a["d"])(t.id).then((function(i){var n=i.data.body;n["id"]=t.id,e.items.push(n),e.index++,e.getItems()})).catch((function(){e.index++,e.getItems()}))},downloadTemplate:function(){var e=this,t=[],n={};this.items.map((function(e){e.variants.map((function(i){n["id"]=e.id,n["product_title"]=e.product.product_title,n["product_des"]=e.product.product_des,n["category"]=e.categories[0].id,n["variant_title"]=i.variant_title,n["variant_code"]=i.variant_code,n["quantity"]=i.quantity,n["weight"]=i.weight,n["price"]=i.price,n["ori_price"]=i.ori_price,n["content"]=e.content,n["shipment_id"]=e.shipment.id,n["on_sale"]=e.product.on_sale,t.push(n),n={}}))}));var s=this.formatJson(this.filterVal,t);Promise.all([i.e("chunk-9a46517a"),i.e("chunk-2d0cc0b6")]).then(i.bind(null,"4bf8")).then((function(t){t.export_json_to_excel({header:e.headers,data:s,filename:"商品修改文件"})}))},formatJson:function(e,t){return t.map((function(t){return e.map((function(e){return t[e]}))}))},excelSuccess:function(e){var t=this,i=e.header,n=e.results,s=i.filter((function(e){return-1===t.headers.indexOf(e)}));s.length>1||1===s.length&&"错误报告"!==s[0]?this.$message.warning("检查到上传表格表头错误，请检查后重新上传"):this.setData(n)},setData:function(e){var t=this;if(0!==e.length){var i=e.filter((function(e){return!e["商品名称(必填)"]||!e["sku名称(必填)"]||!e["sku库存(必填)"]||!e["sku售价(必填)"]||!e["物流模版(必填)"]}));if(0===i.length){var n=[],s={},a={},r=["id","product_title","product_des","content","shipment_id","on_sale"];e.map((function(e){s["variant"]={},t.filterVal.map((function(i,n){a[i]=e[t.headers[n]],"category"===i?(s["categories"]=[],e[t.headers[n]]&&s.categories.push(e[t.headers[n]])):-1!==r.indexOf(i)?s[i]=e[t.headers[n]]:s.variant[i]=e[t.headers[n]]})),n.push(s),t.originalDoc.push(a),s={},a={}}));var o={},c={};n.forEach((function(e){var t=e.id,i=o[t]||{};i={id:e.id,product:{product_title:e.product_title,product_des:e.product_des,on_sale:e.on_sale,shipment_id:e.shipment_id},categories:e.categories,variants:[],content:e.content},o[t]=i})),n.forEach((function(e){var t=e.id,i=c[t]||[];i.push(e.variant),c[t]=i}));var l=Object.keys(o).map((function(e){return o[e]})),d=Object.keys(c).map((function(e){return c[e]}));l.forEach((function(e,t){e.variants=d[t]})),this.data=l}else this.$message.warning("上传文件部分必填项为空，请填写后重新上传")}else this.$message.warning("上传文件内容为空，请重新上传")},close:function(){this.data=[],this.$emit("close")},confirm:function(){this.progress=!0,this.index=0,this.toAdd()},toAdd:function(){var e=this;if(this.index===this.data.length)return this.index+=this.index,0!==this.wrong?(this.$message.warning("部分上传不成功，错误记录将自动下载，请修改后重新上传"),this.downloadWrong()):this.$message.success("上传完毕"),void setTimeout((function(){e.progress=!1,e.index=0,e.wrong=0,e.close(),e.$emit("reload")}),500);var t=this.data[this.index],i=this.data[this.index];Object(a["c"])(t,t.id).then((function(){e.index++,e.toAdd()})).catch((function(t){i["message"]=t.response.data.message,e.error.push(i),e.index++,e.wrong++,e.toAdd()}))},downloadWrong:function(){var e=this,t=this.headers;t.push("错误报告");var n=this.filterVal;n.push("message");var s=[],a={};this.originalDoc.map((function(t){a=t;var i=e.error.filter((function(e){return e.product.product_title===a.product_title}));0!==i.length&&(a["message"]=i[0].message,s.push(a),a={})}));var r=this.formatJson(n,s);Promise.all([i.e("chunk-9a46517a"),i.e("chunk-2d0cc0b6")]).then(i.bind(null,"4bf8")).then((function(e){e.export_json_to_excel({header:t,data:r,filename:"商品上传错误报告"})}))}}},V=O,E=(i("6784"),Object(d["a"])(V,S,j,!1,null,"1b5ad252",null)),z=E.exports,I={components:{ProgressBar:h,GroupAdd:$,GroupEdit:z},data:function(){return{data:[],query:{name:null,page:1,pageSize:15},name:"",total:0,selected:[],loading:!1,progressShow:!1,progressTitle:"",index:0,error:0,addGroupVisible:!1,editGroupVisible:!1,excelData:[],headers:["商品ID","商品名称","商品简介","商品分类","sku名称","sku编号","sku库存","sku重量","sku售价","sku原价","商品详情","物流模版","上架情况"],filterVal:["id","product_title","product_des","category","variant_title","variant_code","quantity","weight","price","ori_price","content","shipment_id","on_sale"]}},created:function(){this.getData()},beforeRouteLeave:function(e,t,i){"ProductItem"===e.name||"ProductAdd"===e.name?t.meta.keepAlive=!0:t.meta.keepAlive=!1,i()},methods:{toAdd:function(){"免费版"===this.$store.getters.shop_level&&this.data.length>=20?this.$message.warning({message:"您当前的商铺为免费版，支持上传1-20件商品，已达到限额，如需上传更多商品，请升级商城",duration:4e3}):this.$router.push({name:"ProductAdd"})},getData:function(){var e=this;this.loading=!0,Object(a["e"])(this.query).then((function(t){e.data=t.data.body.data,e.total=t.data.body.page.total,e.loading=!1})).catch((function(){e.loading=!1}))},handleSizeChange:function(e){this.query.pageSize=e,this.query.page=1,this.getData()},handleCurrentChange:function(e){this.query.page=e,this.getData()},search:function(){this.query.page=1,this.getData()},handleSelect:function(e){this.selected=e},toItem:function(e){this.$router.push({name:"ProductItem",query:{id:e.id}})},toEdit:function(e){this.$router.push({name:"ProductItem",query:{id:e.id}})},changeTitle:function(e){var t=this;this.$prompt("","修改商品名称",{confirmButtonText:"确定",cancelButtonText:"取消",inputValue:e.product_title}).then((function(i){var n=i.value;Object(a["c"])({product:{product_title:n}},e.id).then((function(){t.$message.success("已成功修改"),t.getData()}))}))},changeVisible:function(e){var t=this;Object(a["c"])({product:{on_sale:e.on_sale?0:1}},e.id).then((function(){t.$message.success("已成功修改"),t.getData()}))},toDelete:function(e){var t=this;this.$confirm("删除后无法找回，是否继续？","提示",{confirmButtonText:"确定",cancelButtonText:"取消"}).then((function(){Object(a["b"])(e.id).then((function(){t.$message.success("已成功删除"),t.getData()})).catch((function(){}))})).catch((function(){}))},visibleGroup:function(){0!==this.selected.length?(this.progressShow=!0,this.progressTitle="批量上下架",this.index=0,this.error=0,this.confirmVisible()):this.$message.warning("请先选择商品")},confirmVisible:function(){var e=this;if(this.index!==this.selected.length){var t=this.selected[this.index],i={product:{on_sale:t.on_sale?0:1}};Object(a["c"])(i,t.id).then((function(){e.index+=1,setTimeout((function(){e.confirmVisible()}),100)})).catch((function(){e.index+=1,e.error+=1,setTimeout((function(){e.confirmVisible()}),100)}))}else setTimeout((function(){e.progressShow=!1,e.progressTitle="",e.index=0,e.selected=[],e.$refs.itemTable.clearSelection(),e.getData(),0!==e.error?e.$message.warning({message:e.error+"个商品未能成功修改，请稍后重试",duration:2e3}):e.$message.success("已成功修改")}),1e3)},deleteGroup:function(){0!==this.selected.length?(this.progressShow=!0,this.progressTitle="批量删除",this.index=0,this.error=0,this.confirmDelete()):this.$message.warning("请先选择商品")},confirmDelete:function(){var e=this;if(this.index!==this.selected.length){var t=this.selected[this.index];Object(a["b"])(t.id).then((function(){e.index+=1,setTimeout((function(){e.confirmDelete()}),100)})).catch((function(){e.index+=1,e.error+=1,setTimeout((function(){e.confirmDelete()}),100)}))}else setTimeout((function(){e.progressShow=!1,e.progressTitle="",e.index=0,e.selected=[],e.$refs.itemTable.clearSelection(),e.getData(),0!==e.error?e.$message.warning({message:e.error+"个商品未能成功删除，请稍后重试",duration:2e3}):e.$message.success("已成功删除")}),1e3)},toExport:function(){0!==this.selected.length?(this.progressShow=!0,this.progressTitle="正在获取导出商品信息",this.index=0,this.error=0,this.exportItem()):this.$message.warning("请先选择商品")},toExportAll:function(){this.$loading({text:"正在获取全部商品..."}),this.selectExport()},selectExport:function(){var e=this;if(this.selected.length===this.total)return this.$loading().close(),this.progressShow=!0,this.progressTitle="正在获取导出商品信息",this.index=0,this.error=0,void this.exportItem();var t=this.index+1;Object(a["e"])({page:t,pageSize:100}).then((function(t){t.data.body.data.map((function(t){e.selected.push(t)})),e.index+=1,e.selectExport()})).catch((function(){e.index+=1,e.error+=1,e.selectExport()}))},exportItem:function(){var e=this;if(this.index!==this.selected.length){var t=this.selected[this.index];Object(a["d"])(t.id).then((function(i){var n=i.data.body;n["id"]=t.id,e.excelData.push(n),e.index+=1,e.exportItem()})).catch((function(){e.index+=1,e.error+=1,e.exportItem()}))}else setTimeout((function(){e.downloadTemplate(),e.progressShow=!1,e.progressTitle="",e.$refs.itemTable.clearSelection(),e.index=0,e.error=0}),1e3)},downloadTemplate:function(){var e=this,t=[],n={};this.excelData.map((function(e){e.variants.map((function(i){n["id"]=e.id,n["product_title"]=e.product.product_title,n["product_des"]=e.product.product_des,n["category"]=0!==e.categories.length?e.categories[0].id:"",n["variant_title"]=i.variant_title,n["variant_code"]=i.variant_code,n["quantity"]=i.quantity,n["weight"]=i.weight,n["price"]=i.price,n["ori_price"]=i.ori_price,n["content"]=e.content,n["shipment_id"]=e.shipment.id,n["on_sale"]=e.product.on_sale,t.push(n),n={}}))}));var s=this.formatJson(this.filterVal,t);Promise.all([i.e("chunk-9a46517a"),i.e("chunk-2d0cc0b6")]).then(i.bind(null,"4bf8")).then((function(t){t.export_json_to_excel({header:e.headers,data:s,filename:"商品导出"})}))},formatJson:function(e,t){return t.map((function(t){return e.map((function(e){return t[e]}))}))}}},C=I,q=(i("e216"),i("fa01"),Object(d["a"])(C,n,s,!1,null,"13218791",null));t["default"]=q.exports},bc1f:function(e,t,i){"use strict";var n=i("f5ee"),s=i.n(n);s.a},c4c8:function(e,t,i){"use strict";i.d(t,"e",(function(){return s})),i.d(t,"d",(function(){return a})),i.d(t,"a",(function(){return r})),i.d(t,"c",(function(){return o})),i.d(t,"b",(function(){return c}));var n=i("b775");function s(e){return Object(n["a"])({url:"product",method:"get",params:e})}function a(e){return Object(n["a"])({url:"product/"+e,method:"get"})}function r(e){return Object(n["a"])({url:"product",method:"post",data:e})}function o(e,t){return Object(n["a"])({url:"product/"+t,method:"put",data:e})}function c(e){return Object(n["a"])({url:"product/"+e,method:"delete"})}},e216:function(e,t,i){"use strict";var n=i("1159"),s=i.n(n);s.a},f078:function(e,t,i){},f5ee:function(e,t,i){},fa01:function(e,t,i){"use strict";var n=i("6991"),s=i.n(n);s.a}}]);