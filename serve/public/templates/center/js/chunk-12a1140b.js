(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-12a1140b"],{"40cd":function(t,e,a){},"57e2":function(t,e,a){"use strict";var l=a("ecf5"),n=a.n(l);n.a},ae76:function(t,e,a){"use strict";a.r(e);var l=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{staticClass:"customer-searchbar"},[a("el-input",{model:{value:t.searchValue,callback:function(e){t.searchValue=e},expression:"searchValue"}},[a("el-select",{attrs:{slot:"prepend",placeholder:"请选择"},slot:"prepend",model:{value:t.searchType,callback:function(e){t.searchType=e},expression:"searchType"}},[a("el-option",{attrs:{label:"用户名",value:"username"}}),a("el-option",{attrs:{label:"手机号",value:"mobile"}})],1)],1),a("div",{staticStyle:{margin:"15px 0 10px","text-align":"center"}},[a("el-button",{attrs:{size:"small"},on:{click:t.reset}},[t._v("重置")]),a("el-button",{attrs:{type:"primary",size:"small"},on:{click:t.search}},[t._v("搜索")])],1)],1),a("div",{staticStyle:{"background-color":"#fff","border-radius":"5px"}},[a("el-table",{staticClass:"customer-table",attrs:{data:t.data,loading:t.loading,border:"","header-row-class-name":"table-header-row"}},[a("el-table-column",{attrs:{label:"昵称",prop:"username"}}),a("el-table-column",{attrs:{label:"手机号",prop:"mobile"}}),a("el-table-column",{attrs:{label:"会员等级",prop:"mobile"}}),a("el-table-column",{attrs:{label:"注册时间",prop:"created_at"}}),a("el-table-column",{attrs:{label:"上次登录",prop:"created_at"}}),a("el-table-column",{attrs:{label:"成交总单数",prop:"balance"}}),a("el-table-column",{attrs:{label:"消费总金额",prop:"balance"}}),a("el-table-column",{attrs:{label:"用户钱包余额",width:"120px"},scopedSlots:t._u([{key:"default",fn:function(e){return a("div",{},[a("div",[t._v("¥ "+t._s(e.row.balance))]),a("div",[a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){return t.toWallet(e.row,e.row.id)}}},[t._v("钱包记录")])],1)])}}])}),a("el-table-column",{attrs:{label:"操作",width:"200px"},scopedSlots:t._u([{key:"default",fn:function(e){return a("div",{},[a("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(a){return t.toPay(e.row)}}},[t._v("充值/扣款")]),a("el-button",{attrs:{size:"small"},on:{click:function(a){return t.editPass(e.row)}}},[t._v("修改密码")])],1)}}])})],1),a("el-pagination",{staticStyle:{padding:"20px 0","text-align":"center"},attrs:{"current-page":t.query.page,"page-size":t.query.pageSize,layout:"total, prev, pager, next, jumper",total:t.total},on:{"current-change":t.handleCurrentChange}})],1),a("el-dialog",{attrs:{title:"用户"+t.username+" 钱包记录",width:"800px",visible:t.walletListShow},on:{"update:visible":function(e){t.walletListShow=e}}},[a("div",{directives:[{name:"loading",rawName:"v-loading",value:t.walletLoading,expression:"walletLoading"}]},[a("div",{staticClass:"wallet-title"},[a("strong",[t._v("钱包余额："),a("span",[t._v("¥ "+t._s(t.walletBalance))])])]),a("el-table",{attrs:{data:t.walletData,border:""}},[a("el-table-column",{attrs:{label:"流水号",prop:"no"}}),a("el-table-column",{attrs:{label:"时间",prop:"created_at"}}),a("el-table-column",{attrs:{label:"类型",width:"70px"},scopedSlots:t._u([{key:"default",fn:function(e){return["in"==e.row.type_code?a("el-tag",{attrs:{type:"success"}},[t._v(t._s(e.row.type))]):a("el-tag",{attrs:{type:"danger"}},[t._v(t._s(e.row.type))])]}}])}),a("el-table-column",{attrs:{label:"金额",prop:"amount",width:"100px"}}),a("el-table-column",{attrs:{"show-overflow-tooltip":!0,label:"说明",prop:"content"}})],1),a("el-pagination",{staticStyle:{margin:"20px 0","text-align":"center"},attrs:{"current-page":t.walletQuery.page,"page-size":t.walletQuery.pageSize,layout:"total, prev, pager, next, jumper",total:t.walletTotal},on:{"current-change":t.walletHandleCurrentChange}})],1)]),a("el-dialog",{attrs:{title:"用户 "+t.username+" 充值/扣款",visible:t.payWalletShow},on:{"update:visible":function(e){t.payWalletShow=e}}},[a("el-form",{attrs:{"label-width":"80px"}},[a("el-form-item",{attrs:{label:"金额",required:""}},[a("el-input-number",{attrs:{required:"",min:1,precision:2},model:{value:t.payData.amount,callback:function(e){t.$set(t.payData,"amount",e)},expression:"payData.amount"}})],1),a("el-form-item",{attrs:{label:"业务类型",required:""}},[a("el-select",{attrs:{required:""},model:{value:t.payData.type,callback:function(e){t.$set(t.payData,"type",e)},expression:"payData.type"}},[a("el-option",{attrs:{label:"扣款",value:"out"}}),a("el-option",{attrs:{label:"充值",value:"in"}})],1)],1),a("el-form-item",{attrs:{label:"备注"}},[a("el-input",{attrs:{type:"textarea",rows:3},model:{value:t.payData.content,callback:function(e){t.$set(t.payData,"content",e)},expression:"payData.content"}})],1)],1),a("div",{staticStyle:{"text-align":"right"}},[a("el-button",{on:{click:function(e){t.payWalletShow=!1}}},[t._v("取消")]),a("el-button",{attrs:{type:"primary",loading:t.btnLoading},on:{click:t.payWallet}},[t._v("确认")])],1)],1)],1)},n=[],o=a("b775");function r(t){return Object(o["a"])({url:"customer",method:"get",params:t})}function i(t,e){return Object(o["a"])({url:"customer/"+t,method:"put",data:e})}function s(t,e){return Object(o["a"])({url:"wallet/"+t,method:"get",params:e})}function u(t,e){return Object(o["a"])({url:"wallet/"+t,method:"post",data:e})}function c(t){return Object(o["a"])({url:"wallet/"+t+"/balance",method:"get"})}var p={data:function(){return{loading:!1,query:{page:1,pageSize:15,username:"",mobile:""},total:0,data:[],searchType:"username",searchValue:null,walletListShow:!1,walletData:[],walletLoading:!1,walletCustomerId:null,walletQuery:{page:1,pageSize:5},walletTotal:0,walletBalance:0,username:null,payWalletShow:!1,payData:{amount:100,type:"in",content:null},btnLoading:!1}},created:function(){this.getData()},methods:{getData:function(){var t=this;this.loading=!0,r(this.query).then((function(e){t.data=e.data.body.data,t.total=e.data.body.page.total,t.loading=!1})).catch((function(){t.loading=!1}))},getWalletData:function(){var t=this;this.walletLoading=!0,s(this.walletCustomerId,this.walletQuery).then((function(e){var a=e.data.body;t.walletData=a.data,t.walletTotal=a.page.total,t.walletLoading=!1})),c(this.walletCustomerId).then((function(e){t.walletBalance=e.data.body.balance}))},handleCurrentChange:function(t){this.query.page=t,this.getData()},editPass:function(t){var e=this;this.$prompt("重置后顾客将使用新的密码进行登录，请谨慎操作，并且及时通知顾客密码已变更。如果确认重置，请在下方输入重置密码，并点击重置按钮。","提示",{confirmButtonText:"重置",cancelButtonText:"关闭"}).then((function(a){var l=a.value;i(t.id,{password:l}).then((function(){e.$message.success("操作成功"),e.getData()}))})).catch((function(){}))},search:function(){this.query={page:this.query.page,pageSize:this.query.pageSize},this.query[this.searchType]=this.searchValue,this.getData()},reset:function(){this.query={page:1,pageSize:15},this.getData()},toWallet:function(t,e){this.walletListShow=!0,this.walletCustomerId=e,this.walletData=[],this.walletBalance=0,this.username=t.username,this.getWalletData()},walletHandleCurrentChange:function(t){this.walletQuery.page=t,this.getWalletData()},toPay:function(t){this.username=t.username,this.walletCustomerId=t.id,this.payData={amount:100,type:"in",content:null},this.payWalletShow=!0},payWallet:function(){var t=this;this.btnLoading=!0,u(this.walletCustomerId,this.payData).then((function(){t.payWalletShow=!1,t.$message.success("in"===t.payData.type?"充值":"扣款成功"),t.getData(),t.btnLoading=!1})).catch((function(){t.btnLoading=!1}))}}},d=p,h=(a("57e2"),a("e633"),a("2877")),b=Object(h["a"])(d,l,n,!1,null,"c9a4bd2c",null);e["default"]=b.exports},e633:function(t,e,a){"use strict";var l=a("40cd"),n=a.n(l);n.a},ecf5:function(t,e,a){}}]);